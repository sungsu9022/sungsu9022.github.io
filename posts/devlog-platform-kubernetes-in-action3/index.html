<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="[kubernetes-in-action] 3. 파드 : 쿠버네티스에서 컨테이너 실행" /><meta name="author" content="sungsu park" /><meta property="og:locale" content="en" /><meta name="description" content="3. 파드 : 쿠버네티스에서 컨테이너 실행 3.1 파드 소개 파드는 함께 배치된 컨테이너 그룹이며, 쿠버네티스의 기본 빌딩 블록. 컨테이너를 개별적으로 배포하기보다는 컨테이너를 가진 파드를 배포하고, 운영한다. 무조건 2개 이상을 컨테이너를 포함시키라는 의미는 아니고 일반적으로는 하나의 컨테이너만 포함된다. 파드의 핵심은 파드가 여러 컨테이너를 가지고 있을 경우 모든 컨테이너는 항상 하나의 워커 노드에서 실행되고, 여러 워커 노드에 걸쳐 실행되지 않는다는것." /><meta property="og:description" content="3. 파드 : 쿠버네티스에서 컨테이너 실행 3.1 파드 소개 파드는 함께 배치된 컨테이너 그룹이며, 쿠버네티스의 기본 빌딩 블록. 컨테이너를 개별적으로 배포하기보다는 컨테이너를 가진 파드를 배포하고, 운영한다. 무조건 2개 이상을 컨테이너를 포함시키라는 의미는 아니고 일반적으로는 하나의 컨테이너만 포함된다. 파드의 핵심은 파드가 여러 컨테이너를 가지고 있을 경우 모든 컨테이너는 항상 하나의 워커 노드에서 실행되고, 여러 워커 노드에 걸쳐 실행되지 않는다는것." /><link rel="canonical" href="https://sungsu9022.github.io/posts/devlog-platform-kubernetes-in-action3/" /><meta property="og:url" content="https://sungsu9022.github.io/posts/devlog-platform-kubernetes-in-action3/" /><meta property="og:site_name" content="Sungsu’s Tech Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-08-03T17:34:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[kubernetes-in-action] 3. 파드 : 쿠버네티스에서 컨테이너 실행" /><meta name="twitter:site" content="@sungsu9022dev" /><meta name="twitter:creator" content="@sungsu park" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"sungsu park"},"dateModified":"2020-08-03T17:34:00+09:00","datePublished":"2020-08-03T17:34:00+09:00","description":"3. 파드 : 쿠버네티스에서 컨테이너 실행 3.1 파드 소개 파드는 함께 배치된 컨테이너 그룹이며, 쿠버네티스의 기본 빌딩 블록. 컨테이너를 개별적으로 배포하기보다는 컨테이너를 가진 파드를 배포하고, 운영한다. 무조건 2개 이상을 컨테이너를 포함시키라는 의미는 아니고 일반적으로는 하나의 컨테이너만 포함된다. 파드의 핵심은 파드가 여러 컨테이너를 가지고 있을 경우 모든 컨테이너는 항상 하나의 워커 노드에서 실행되고, 여러 워커 노드에 걸쳐 실행되지 않는다는것.","headline":"[kubernetes-in-action] 3. 파드 : 쿠버네티스에서 컨테이너 실행","mainEntityOfPage":{"@type":"WebPage","@id":"https://sungsu9022.github.io/posts/devlog-platform-kubernetes-in-action3/"},"url":"https://sungsu9022.github.io/posts/devlog-platform-kubernetes-in-action3/"}</script><title>[kubernetes-in-action] 3. 파드 : 쿠버네티스에서 컨테이너 실행 | Sungsu's Tech Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Sungsu's Tech Blog"><meta name="application-name" content="Sungsu's Tech Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/personal/sunny.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Sungsu's Tech Blog</a></div><div class="site-subtitle font-italic">Java/Kotlin Spring, Back-end</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/sungsu9022" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/sungsu9022dev" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['sungsu9022','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[kubernetes-in-action] 3. 파드 : 쿠버네티스에서 컨테이너 실행</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[kubernetes-in-action] 3. 파드 : 쿠버네티스에서 컨테이너 실행</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1596443640" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 3, 2020 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6490 words"> <em>36 min</em> read</span></div></div></div><div class="post-content"><h1 id="3-파드--쿠버네티스에서-컨테이너-실행">3. 파드 : 쿠버네티스에서 컨테이너 실행</h1><h2 id="31-파드-소개"><span class="mr-2">3.1 파드 소개</span><a href="#31-파드-소개" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>파드는 함께 배치된 컨테이너 그룹이며, 쿠버네티스의 기본 빌딩 블록.<li>컨테이너를 개별적으로 배포하기보다는 컨테이너를 가진 파드를 배포하고, 운영한다.<li>무조건 2개 이상을 컨테이너를 포함시키라는 의미는 아니고 일반적으로는 하나의 컨테이너만 포함된다.<li>파드의 핵심은 파드가 여러 컨테이너를 가지고 있을 경우 모든 컨테이너는 항상 하나의 워커 노드에서 실행되고, 여러 워커 노드에 걸쳐 실행되지 않는다는것.</ul><p><a href="https://user-images.githubusercontent.com/6982740/89205974-88f8d700-d5f3-11ea-9b35-03282b3c5f3e.png" class="popup img-link "><img width="624" alt="스크린샷 2020-08-04 오전 1 40 29" data-src="https://user-images.githubusercontent.com/6982740/89205974-88f8d700-d5f3-11ea-9b35-03282b3c5f3e.png" class="lazyload" data-proofer-ignore></a></p><h3 id="311-파드가-필요한-이유"><span class="mr-2">3.1.1 파드가 필요한 이유</span><a href="#311-파드가-필요한-이유" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>여러 프로세스를 실행하는 단일 컨테이너보다 다중 컨테이너가 좋기 때문<li>쿠버네티스에서는 프로세스를 항상 컨테이너에서 실행시키고, 각각의 컨테이너는 격리된 머신과 비슷하다. 그래서 여러 프로세스를 단일 컨테이너 안에서 실행하는것이 타당한것처럼 보일수 있는데.<li>컨테이너는 단일 프로세스를 실행하는 것을 목적으로 설계되었음.<li>그래서 각 프로세스를 자체의 개별 컨테이너로 실행해야 한다.<li>하지만 실제 서비스 상황에서는 여러개의 컨테이너를 포함시킬 수 있는 개념이 필요할 수 있음.<ul><li>예를 들면 WAS를 쿠버네티스로 서빙한다고 했을떄 쿠버네티스 스케줄러에 의해서 pod이 존재하는 노드는 언제든 수시로 변경될 수 있는데 이 경우 로그가 유실될 수 있기 때문에 이런 로그를 유실되지 않기 위해서는 로그를 중앙저장소로 보내주는 별도의 프로세스가 있어야 함. 이 경우 파드 구성을 WAS 컨테이너 + 로그전송 프로세스 컨테이너로 하여 하기 위함이 아닌가 싶음.</ul></ul><h3 id="312-파드-이해하기"><span class="mr-2">3.1.2 파드 이해하기</span><a href="#312-파드-이해하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>여러 프로세스를 단일 컨테이너로 묶지 않기 때문에 컨테이너를 함께 묶고 하나의 단위로 관리할 수 있는 또 다른 상위 구조가 필요하다. (파드가 필요한 이유)<li>컨테이너가 제공하는 모든 기능을 활용하는 동시에 프로세스가 함께 실행되는것처럼 보이게 할수 있음.</ul><h4 id="같은-파드에서-컨테이너-간-부분-격리"><span class="mr-2">같은 파드에서 컨테이너 간 부분 격리</span><a href="#같은-파드에서-컨테이너-간-부분-격리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>쿠버네티스는 파드 안에 있는 모든 컨테이너가 자체 네임스페이스가 아닌 동일한 리눅스 네임스페이스를 공유하도록 도커를 설정<li>즉 동일한 네트워크 네임스페이스, UTS(Unix Timesharing System, 호스트 이름을 네임스페이스로 격리) 안에서 실행되므로 같은 파드 내에서 이것들을 서로 공유할 수 있다.<li>여기서 주의할 점은 파일시스템같은 경우는 컨테이너 이미지에서 나오기 때문에 기본적으로 완전히 분리된다고 보면 된다.<li>쿠버네티스 볼륨 개념을 이용하면 컨테이너간 파일 디렉터리를 공유하는것도 가능</ul><h4 id="컨테이너가-동일한-ip와-포트-공간을-공유하는-방법"><span class="mr-2">컨테이너가 동일한 IP와 포트 공간을 공유하는 방법</span><a href="#컨테이너가-동일한-ip와-포트-공간을-공유하는-방법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>파드 안의 컨테이너가 동일한 네트워크 네임스페이스에서 실행되기 때문에 도일한 IP주소와 포트공간을 공유한다.<li>그래서 동일한 파드 안 컨테이너에서 실행되는 프로세스들은 같은 포트번호를 사용하지 않도록 해야 한다.<li>파드 안의 컨테이너들끼리는 로컬호스트를 통해 서로 통신이 가능(동일한 루프백 네트워크 인터페이스를 갖음)</ul><h4 id="파드간-플랫-네트워크-소개"><span class="mr-2">파드간 플랫 네트워크 소개</span><a href="#파드간-플랫-네트워크-소개" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>모든 파드는 하나의 플랫한 공유 네트워크 주소 공간에 상주<li>모든 파드는 다른 파드의 IP주소를 사용해 접근이 가능하다.<li>LAN과 유사한 방식으로 상호 통신이 가능<li>파드는 논리적인 호스트로서 컨테이너가 아닌 환경에서의 물리적 호스트 혹은 VM과 매우 유사하게 동작함.</ul><p><a href="https://user-images.githubusercontent.com/6982740/89205891-68308180-d5f3-11ea-8c93-1449b61e04ea.png" class="popup img-link "><img width="569" alt="스크린샷 2020-08-04 오전 1 39 48" data-src="https://user-images.githubusercontent.com/6982740/89205891-68308180-d5f3-11ea-8c93-1449b61e04ea.png" class="lazyload" data-proofer-ignore></a></p><h3 id="313-파드에서-컨테이너의-적절한-구성"><span class="mr-2">3.1.3 파드에서 컨테이너의 적절한 구성</span><a href="#313-파드에서-컨테이너의-적절한-구성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="다계층-애플리케이션을-여러-파드로-분할"><span class="mr-2">다계층 애플리케이션을 여러 파드로 분할</span><a href="#다계층-애플리케이션을-여러-파드로-분할" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>프론트엔드와 백엔드 예제에서 파드를 2개로 분리하면 쿠버네티스가 프론트엔드를 한 노드로 백엔드는 다른 노드에 스케줄링해서 인프라스트러겨의 활용도를 향상시킬수 있음.<li>이게 만약 같은 파드에 있다면 둘중 항상 같은 노드에서 실행되겠지만, 서로 필요한 리소스의 양은 다를수 있기에 분리하는것이 좋다.</ul><h4 id="개별-확장이-가능하도록-여러-파드로-분할"><span class="mr-2">개별 확장이 가능하도록 여러 파드로 분할</span><a href="#개별-확장이-가능하도록-여러-파드로-분할" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>두 컨테이너를 하나의 파드에 넣지 말아야하는 이유 중 하나는 “스케일링” 때문<li>쿠버네티스 스케줄링 기본 단위는 파드이다.<li>쿠버네티스에서는 컨테이너 단위로 수평 확장할수 없고 파드 단위로만 수평확장(scale out)이 가능하다.<li>컨테이너를 개별적으로 스케일링하는 것이 필요하다고 판단되는 경우 별도 파드에 배포하자.</ul><h4 id="파드에서-여러-컨테이너를-사용하는-경우"><span class="mr-2">파드에서 여러 컨테이너를 사용하는 경우</span><a href="#파드에서-여러-컨테이너를-사용하는-경우" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>애플리케이션이 하나의 주요 프로세스와 하나 이상의 보안 프로세스로 구성된 경우<li>특정 디렉터리에서 파일을 제공하는 웹서버로 예를 들자면 주 컨테이너는 웹서버라고 하고, 추가 컨테이너(사이드카 컨테이너)는 외부 소스에서 주기적으로 콘텐츠를 받아 웹서버 디렉터리에 저장하는 방식을 예로 들수 있다.(ex. sitemap을 받아와서 디렉터리에서 저장하는 것과 같은)<li>다른 에제로는 로그 로테이터와 수집기, 데이터 프로세서, 통신 어댑터 등이 있을수 있다.</ul><p><a href="https://user-images.githubusercontent.com/6982740/89205749-2a335d80-d5f3-11ea-9b3d-825fe1bfb0b4.png" class="popup img-link "><img width="573" alt="스크린샷 2020-08-04 오전 1 38 03" data-src="https://user-images.githubusercontent.com/6982740/89205749-2a335d80-d5f3-11ea-9b3d-825fe1bfb0b4.png" class="lazyload" data-proofer-ignore></a></p><h4 id="파드에서-여러-컨테이너를-사용하는-경우-결정"><span class="mr-2">파드에서 여러 컨테이너를 사용하는 경우 결정</span><a href="#파드에서-여러-컨테이너를-사용하는-경우-결정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>컨테이너를 함께 실행해야 하는가? 혹은 서로 다른 호스트에서 실행할 수 있는가?<li>여러 컨테이너가 모여 하나의 구성 요소로 나타내는가? 혹은 개별적인 구성 요소인가?<li>컨테이너가 함꼐, 혹은 개별적으로 스케일링돼야 하는가?<li>컨테이너는 여러 프로세스를 실행시키지 말아야하고, 파드는 동일한 머신에서 실행할 필요가 없다면 여러 컨테이너를 포함하지 말아야 한다.</ul><h2 id="32-yaml-또는-json-디스크립터로-파드-생성"><span class="mr-2">3.2 YAML 또는 JSON 디스크립터로 파드 생성</span><a href="#32-yaml-또는-json-디스크립터로-파드-생성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>kubectl run 명령어를 이용해서 리소스를 만들수도 있지만, yaml 파일에 모든 쿠버네티스 오브젝트를 정의하면 버전 관리 시스템에 넣는것도 가능하고, 모든 이점을 누릴수 있다.</ul><h3 id="321-기존-파드의-yaml-디스크립터-살펴보기"><span class="mr-2">3.2.1 기존 파드의 YAML 디스크립터 살펴보기</span><a href="#321-기존-파드의-yaml-디스크립터-살펴보기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
</pre><td class="rouge-code"><pre><span class="c1"># 메타 데이터</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">creationTimestamp</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2020-08-03T14:21:44Z"</span>
  <span class="na">generateName</span><span class="pi">:</span> <span class="s">kubia-</span>
  <span class="na">labels</span><span class="pi">:</span>
    <span class="na">run</span><span class="pi">:</span> <span class="s">kubia</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">kubia-5wsx8</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">ownerReferences</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
    <span class="na">blockOwnerDeletion</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">controller</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">kind</span><span class="pi">:</span> <span class="s">ReplicationController</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">kubia</span>
    <span class="na">uid</span><span class="pi">:</span> <span class="s">cb311984-2974-4434-8979-b7a11f07388d</span>
  <span class="na">resourceVersion</span><span class="pi">:</span> <span class="s2">"</span><span class="s">4551"</span>
  <span class="na">selfLink</span><span class="pi">:</span> <span class="s">/api/v1/namespaces/default/pods/kubia-5wsx8</span>
  <span class="na">uid</span><span class="pi">:</span> <span class="s">ed4f042e-f547-4003-9a89-8005bca02f60</span>
<span class="c1"># 스펙</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">image</span><span class="pi">:</span> <span class="s">sungsu9022/kubia</span>
    <span class="na">imagePullPolicy</span><span class="pi">:</span> <span class="s">Always</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">kubia</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">8080</span>
      <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
    <span class="na">resources</span><span class="pi">:</span> <span class="pi">{}</span>
    <span class="na">terminationMessagePath</span><span class="pi">:</span> <span class="s">/dev/termination-log</span>
    <span class="na">terminationMessagePolicy</span><span class="pi">:</span> <span class="s">File</span>
    <span class="na">volumeMounts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">mountPath</span><span class="pi">:</span> <span class="s">/var/run/secrets/kubernetes.io/serviceaccount</span>
      <span class="na">name</span><span class="pi">:</span> <span class="s">default-token-zszt7</span>
      <span class="na">readOnly</span><span class="pi">:</span> <span class="kc">true</span>
  <span class="na">dnsPolicy</span><span class="pi">:</span> <span class="s">ClusterFirst</span>
  <span class="na">enableServiceLinks</span><span class="pi">:</span> <span class="kc">true</span>
  <span class="na">nodeName</span><span class="pi">:</span> <span class="s">docker-desktop</span>
  <span class="na">priority</span><span class="pi">:</span> <span class="m">0</span>
  <span class="na">restartPolicy</span><span class="pi">:</span> <span class="s">Always</span>
  <span class="na">schedulerName</span><span class="pi">:</span> <span class="s">default-scheduler</span>
  <span class="na">securityContext</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">serviceAccount</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">serviceAccountName</span><span class="pi">:</span> <span class="s">default</span>
  <span class="na">terminationGracePeriodSeconds</span><span class="pi">:</span> <span class="m">30</span>
  <span class="na">tolerations</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">effect</span><span class="pi">:</span> <span class="s">NoExecute</span>
    <span class="na">key</span><span class="pi">:</span> <span class="s">node.kubernetes.io/not-ready</span>
    <span class="na">operator</span><span class="pi">:</span> <span class="s">Exists</span>
    <span class="na">tolerationSeconds</span><span class="pi">:</span> <span class="m">300</span>
  <span class="pi">-</span> <span class="na">effect</span><span class="pi">:</span> <span class="s">NoExecute</span>
    <span class="na">key</span><span class="pi">:</span> <span class="s">node.kubernetes.io/unreachable</span>
    <span class="na">operator</span><span class="pi">:</span> <span class="s">Exists</span>
    <span class="na">tolerationSeconds</span><span class="pi">:</span> <span class="m">300</span>
  <span class="na">volumes</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">default-token-zszt7</span>
    <span class="na">secret</span><span class="pi">:</span>
      <span class="na">defaultMode</span><span class="pi">:</span> <span class="m">420</span>
      <span class="na">secretName</span><span class="pi">:</span> <span class="s">default-token-zszt7</span>
<span class="na">status</span><span class="pi">:</span>
  <span class="na">conditions</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">lastProbeTime</span><span class="pi">:</span> <span class="kc">null</span>
    <span class="na">lastTransitionTime</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2020-08-03T14:21:44Z"</span>
    <span class="na">status</span><span class="pi">:</span> <span class="s2">"</span><span class="s">True"</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">Initialized</span>
  <span class="pi">-</span> <span class="na">lastProbeTime</span><span class="pi">:</span> <span class="kc">null</span>
    <span class="na">lastTransitionTime</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2020-08-03T14:21:49Z"</span>
    <span class="na">status</span><span class="pi">:</span> <span class="s2">"</span><span class="s">True"</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">Ready</span>
  <span class="pi">-</span> <span class="na">lastProbeTime</span><span class="pi">:</span> <span class="kc">null</span>
    <span class="na">lastTransitionTime</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2020-08-03T14:21:49Z"</span>
    <span class="na">status</span><span class="pi">:</span> <span class="s2">"</span><span class="s">True"</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">ContainersReady</span>
  <span class="pi">-</span> <span class="na">lastProbeTime</span><span class="pi">:</span> <span class="kc">null</span>
    <span class="na">lastTransitionTime</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2020-08-03T14:21:44Z"</span>
    <span class="na">status</span><span class="pi">:</span> <span class="s2">"</span><span class="s">True"</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">PodScheduled</span>
<span class="c1"># Status</span>
  <span class="na">containerStatuses</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">containerID</span><span class="pi">:</span> <span class="s">docker://796528475e929b9f1ec28fc5ae3ca722f1279b8f852b262dfef549bbdebdcd7a</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">sungsu9022/kubia:latest</span>
    <span class="na">imageID</span><span class="pi">:</span> <span class="s">docker-pullable://sungsu9022/kubia@sha256:3811562a9c1c45f2e03352bf99cacf4e024f9c3a874a3d862f0208367eace763</span>
    <span class="na">lastState</span><span class="pi">:</span> <span class="pi">{}</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">kubia</span>
    <span class="na">ready</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">restartCount</span><span class="pi">:</span> <span class="m">0</span>
    <span class="na">started</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">state</span><span class="pi">:</span>
      <span class="na">running</span><span class="pi">:</span>
        <span class="na">startedAt</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2020-08-03T14:21:48Z"</span>
  <span class="na">hostIP</span><span class="pi">:</span> <span class="s">192.168.65.3</span>
  <span class="na">phase</span><span class="pi">:</span> <span class="s">Running</span>
  <span class="na">podIP</span><span class="pi">:</span> <span class="s">10.1.0.13</span>
  <span class="na">podIPs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">ip</span><span class="pi">:</span> <span class="s">10.1.0.13</span>
  <span class="na">qosClass</span><span class="pi">:</span> <span class="s">BestEffort</span>
  <span class="na">startTime</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2020-08-03T14:21:44Z"</span>

</pre></table></code></div></div><h4 id="파드를-정의하는-주요-부분-소개"><span class="mr-2">파드를 정의하는 주요 부분 소개</span><a href="#파드를-정의하는-주요-부분-소개" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>Metadata : 이름, 네임스페이스, 레이블 및 파드에 관한 기타 정보를 포함<li>Spec : 파드 컨테이너, 볼륨, 기타 데이터 등 파드 자체에 관한 실제 명세를 가진다.<li>Status : 파드 상태, 각 컨테이너 설명과 상태, 파드 내부 IP, 기타 기본 정보 등 현재 실행중인 파드에 관한 정보 포함(새 파드를 만들때는 작성하지 않는 내용)</ul><h3 id="322-파드를-정의하는-간단한-yaml-정의"><span class="mr-2">3.2.2 파드를 정의하는 간단한 YAML 정의</span><a href="#322-파드를-정의하는-간단한-yaml-정의" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">kubia-manual</span>  <span class="c1"># 파드 이름</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">image</span><span class="pi">:</span> <span class="s">luksa/kubia</span> <span class="c1"># 컨테이너 이미</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">kubia</span> <span class="c1"># 컨테이너 이름</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">8080</span> <span class="c1"># 애플리케이션 수신 포트</span>
      <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
</pre></table></code></div></div><h4 id="컨테이너-포트-지정"><span class="mr-2">컨테이너 포트 지정</span><a href="#컨테이너-포트-지정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>스펙에 포트를 명시하지않아도 해당 파트에 접속할 수 있으나, 명시적으로 정의해주면 클러스터를 사용하는 모든 사람이 파드에 노출한 포트를 빠르게 볼 수 있어서 정의하는 것이 좋음.</ul><h4 id="오브젝트-필드들에-대한-설명-확인도움말같은"><span class="mr-2">오브젝트 필드들에 대한 설명 확인(도움말같은)</span><a href="#오브젝트-필드들에-대한-설명-확인도움말같은" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>kubectl explain pods
kubectl explain pod.spec
</pre></table></code></div></div><h3 id="323-kubectl-create-명령으로-파드-만들기"><span class="mr-2">3.2.3 kubectl create 명령으로 파드 만들기</span><a href="#323-kubectl-create-명령으로-파드-만들기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>yaml 또는 json 파일로 리소스를 동일하게 만들 수 있음.</ul><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl create <span class="nt">-f</span> kubia-manual.yaml
</pre></table></code></div></div><h4 id="실행중인-파드의-전체-정의-가져오기"><span class="mr-2">실행중인 파드의 전체 정의 가져오기</span><a href="#실행중인-파드의-전체-정의-가져오기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>kubectl get po kubia-manual <span class="nt">-o</span> yaml
kubectl get po kubia-manual <span class="nt">-o</span> json
</pre></table></code></div></div><h3 id="324-애플리케이션-로그-보기"><span class="mr-2">3.2.4 애플리케이션 로그 보기</span><a href="#324-애플리케이션-로그-보기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>컨테이너 런타임(도커)은 스트림을 파일로 전달하고 아래 명령을 이용해 컨테이너 로그를 가져온다.</ul><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker log &lt;container <span class="nb">id</span><span class="o">&gt;</span>
</pre></table></code></div></div><ul><li>쿠버네티스 logs를 이용해 파드 로그 가져오기<div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl logs kubia-manual
</pre></table></code></div></div><li>파드에 컨테이너가 하나만 있다면 로그를 가져오는 것은 매우 간단함<li>컨테이너 로그는 하루 단위로, 로그 파일이 10MD 크기에 도달할때마다 로테이션 되기 떄문에 별도로 로그 관리하는 방식이 필요할듯</ul><h4 id="컨테이너-이름을-지정해-다중-컨테이너-파드에서-로그-가져오기"><span class="mr-2">컨테이너 이름을 지정해 다중 컨테이너 파드에서 로그 가져오기</span><a href="#컨테이너-이름을-지정해-다중-컨테이너-파드에서-로그-가져오기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl logs kubia-manual <span class="nt">-c</span> kubia
</pre></table></code></div></div><ul><li>현재 존재하는 파드의 컨테이너 로그만 가져올수 있음.<li>파드가 삭제되면 로그도 같이 삭제된다.<li>일반적인 서비스 환경에서는 클러스터 전체의 중앙집중식 로깅을 설정하는 것이 좋음</ul><h3 id="325-파드에-요청-보내기"><span class="mr-2">3.2.5 파드에 요청 보내기</span><a href="#325-파드에-요청-보내기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>기존에 <code class="language-plaintext highlighter-rouge">kubectl expose</code> 명령으로 외부에서 파드에 접속할 수 있는 서비스를 만들었었는데<li>“포트 포워딩” 방식을 이용해 테스트와 디버깅 목적으로 연결할수 있음.</ul><h4 id="로컬-네트워크-포트를-파드의-포트로-포워딩"><span class="mr-2">로컬 네트워크 포트를 파드의 포트로 포워딩</span><a href="#로컬-네트워크-포트를-파드의-포트로-포워딩" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>서비스를 거치지 않고 특정 파드와 통신하고 싶을때 쿠버네티스는 해당 파드로 향하나느 포트 포워딩을 구성해준다.<li>아래와 같인 하면 localhost:8888로 해당 파드의 8080포트와 연결시킬 수 있다.</ul><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl port-forward kubia-manual 8888:8080
</pre></table></code></div></div><p><a href="https://user-images.githubusercontent.com/6982740/89206075-afb70d80-d5f3-11ea-8fb4-68cb03125e1e.png" class="popup img-link "><img width="619" alt="스크린샷 2020-08-04 오전 1 41 51" data-src="https://user-images.githubusercontent.com/6982740/89206075-afb70d80-d5f3-11ea-8fb4-68cb03125e1e.png" class="lazyload" data-proofer-ignore></a></p><h2 id="33-레이블을-이용한-파드-구성"><span class="mr-2">3.3 레이블을 이용한 파드 구성</span><a href="#33-레이블을-이용한-파드-구성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>파드 수가 증가함에 따라 파드를 부분집합으로 분류할 필요가 있음.<li>MSA에서 배포된 서비스가 매우 많고 여기서 여러 버전 혹은 릴리스(안정, 베타 카나리 등)이 동시에 실행될수도 있는데 이러면 시스템에 수백개의 파드가 생길수 있고 이를 정리할 매커니즘이 필요한데 이것이 레이블이다.<li>레이블을 통해 파드와 기타 다른 쿰버네티스 오브젝트의 조직화를 할 수 있음(파드 뿐만 아니라 다른 쿠버네티스 리소스 가능)</ul><p><a href="https://user-images.githubusercontent.com/6982740/89205789-3b7c6a00-d5f3-11ea-92af-77e37a044e09.png" class="popup img-link "><img width="695" alt="스크린샷 2020-08-04 오전 1 38 37" data-src="https://user-images.githubusercontent.com/6982740/89205789-3b7c6a00-d5f3-11ea-92af-77e37a044e09.png" class="lazyload" data-proofer-ignore></a></p><h3 id="331-레이블-소개"><span class="mr-2">3.3.1 레이블 소개</span><a href="#331-레이블-소개" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>파드와 모든 쿠버네티스 리소스를 조직화할 수 있는 단순하면서 강력한 기능<li>리소스에 첨부하는 키-값 쌍<li>레이블 셀렉터를 사용해 리소스를 선택할때 호라용<li>레이블 키가 해당 리소스 내에서 고유하다면 하나 이상 원하는 만큼의 레이블을 가질 수 있다.</ul><p><a href="https://user-images.githubusercontent.com/6982740/89206037-a0d05b00-d5f3-11ea-8a22-0b50caabf600.png" class="popup img-link "><img width="697" alt="스크린샷 2020-08-04 오전 1 41 19" data-src="https://user-images.githubusercontent.com/6982740/89206037-a0d05b00-d5f3-11ea-8a22-0b50caabf600.png" class="lazyload" data-proofer-ignore></a></p><h3 id="332-파드를-생성할-때-레이블-지정"><span class="mr-2">3.3.2 파드를 생성할 때 레이블 지정</span><a href="#332-파드를-생성할-때-레이블-지정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>kubia-manual-with-labels.yaml</ul><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">kubia-manual-v2</span>
  <span class="na">labels</span><span class="pi">:</span> <span class="c1"># 레이블 2개 지정</span>
    <span class="na">creation_method</span><span class="pi">:</span> <span class="s">manual</span>
    <span class="na">env</span><span class="pi">:</span> <span class="s">prod</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">image</span><span class="pi">:</span> <span class="s">luksa/kubia</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">kubia</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">8080</span>
      <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c"># Pod 생성</span>
kubectl create <span class="nt">-f</span> kubia-manual-with-labels.yaml

<span class="c"># pod label 정보 조회</span>
kubectl get po <span class="nt">--show-labels</span>

<span class="c"># 특정 레이블에만 관심 있는 경우 -L 스위치를 지정해 각 레이블을 자체 열에 표시할 수 있음.</span>
kubectl get po <span class="nt">-L</span> creation_method,env
</pre></table></code></div></div><h3 id="333-기존-파드-레이블-수정"><span class="mr-2">3.3.3 기존 파드 레이블 수정</span><a href="#333-기존-파드-레이블-수정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c"># 기존 pods 레이블 추가</span>
kubectl label po kubia-manual <span class="nv">creation_method</span><span class="o">=</span>manual

<span class="c"># pods 레이블 수정</span>
kubectl label po kubia-manual-v2 <span class="nb">env</span><span class="o">=</span>debug <span class="nt">--overwrite</span>

<span class="c"># 레이블 조회</span>
kubectl get po <span class="nt">-L</span> creation_method,env
</pre></table></code></div></div><h2 id="34-레이블-셀렉터를-이용한-파드-부분-집합-나열"><span class="mr-2">3.4 레이블 셀렉터를 이용한 파드 부분 집합 나열</span><a href="#34-레이블-셀렉터를-이용한-파드-부분-집합-나열" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>레이블이 중요한 이유는 레이블 셀렉터와 함꼐 사용된다는 것이다.<li>레이블 셀렉터는 리소스 중에서 다음 기준에 따라 리소르를 선택한다.</ul><blockquote><ol><li>특정한 키를 포함하거나 포함하지 않는 레이블<li>특정한 키와 값을 가진 레이블<li>특정한 키를 갖고 있지만, 다른 값을 가진 레이블</ol></blockquote><h3 id="341-레이블-셀렉터를-사용해-파드-나열"><span class="mr-2">3.4.1 레이블 셀렉터를 사용해 파드 나열</span><a href="#341-레이블-셀렉터를-사용해-파드-나열" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c"># creation_method 레이블 manual을 가지고 있는 파드 나열</span>
kubectl get po <span class="nt">-l</span> <span class="nv">creation_method</span><span class="o">=</span>manual

<span class="c"># env를 가지고 있는 파드 나열</span>
kubectl get po <span class="nt">-l</span> <span class="nb">env</span>

<span class="c"># env를 가지고 있지 않은 파드 나열</span>
kubectl get po <span class="nt">-l</span> <span class="s1">'!env'</span>

<span class="c"># creation_method 레이블을 가진 것중에 값이 manual이 아닌것</span>
kubectl get po <span class="nt">-l</span> <span class="s1">'creation_method!=manual'</span>

kubectl get po <span class="nt">-l</span> <span class="s1">'env in (prod,devel)'</span>

kubectl get po <span class="nt">-l</span> <span class="s1">'env notin (prod,devel)'</span>
</pre></table></code></div></div><h3 id="342-레이블-셀렉터에서-여러-조건-사용"><span class="mr-2">3.4.2 레이블 셀렉터에서 여러 조건 사용</span><a href="#342-레이블-셀렉터에서-여러-조건-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># 셀렉터는 쉼표로 구분된 여러 기준을 포함하는 것도 가능하다.</span>
kubectl get po <span class="nt">-l</span> <span class="nv">creation_method</span><span class="o">=</span>manual,env<span class="o">=</span>debug
</pre></table></code></div></div><ul><li>레이블 셀렉터를 이용해 여러 파드를 한번에 삭제할수도 있음.</ul><h2 id="35-레이블과-셀렉터를-이용해-파드-스케줄링-제한"><span class="mr-2">3.5 레이블과 셀렉터를 이용해 파드 스케줄링 제한</span><a href="#35-레이블과-셀렉터를-이용해-파드-스케줄링-제한" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>파드 스케줄링할 노드를 결정할 떄 영향을 미치고 싶은 상황이 있을수 있음.<li>SSD를 가지고 있는 워커 노드에 할당해야 하는 경우<li>이때 특정노드를 지정하는 방법은 좋은것은 아님(아마도 노드이름이나 별도의 정보를 기준으로 하는것을 말하는듯)<li>노드를 지정하는 대신 필요한 노드 요구사항을 기술하고 쿠버네티스가 요구사항을 만족하는 노드를 직접 선택하도록 해야 하는데 이때 노드 레이블과 레이블 셀렉터를 통해서 할 수 있다.<ul><li>SSD 노드가 2개가 있을떄 A노드로 지정을 해버리면 혹시 A노드에 문제가 생기면 스케줄링을 재대로 못할수 있다는 의미(만약 저런 지정이 없었다면 B로 스케줄링 되었을것)</ul></ul><h3 id="351-워커-노드-분류에-레이블-사용"><span class="mr-2">3.5.1 워커 노드 분류에 레이블 사용</span><a href="#351-워커-노드-분류에-레이블-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>노드를 포함한 모든 쿠버네티스 오브젝트에 레이블을 부착할수 있기 때문에 노드 분류에 레이블을 사용하고 쿠버네티스가 스케줄링할때 활용할 수 있다.</ul><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># 이런식으로 노드에 label을 붙인다.(로컬에서 docker-desktop밖에 없어서 직접해보지는 ㅇ낳음)</span>
kubectl label node gke-kubia-85f6-node-0rrx <span class="nv">gpu</span><span class="o">=</span><span class="nb">true</span>

<span class="c"># 노드 조회</span>
kubectl get nodes <span class="nt">-l</span> <span class="nv">gpu</span><span class="o">=</span><span class="nb">true</span>
</pre></table></code></div></div><h3 id="352-특정-노드에-파드-스케줄링"><span class="mr-2">3.5.2 특정 노드에 파드 스케줄링</span><a href="#352-특정-노드에-파드-스케줄링" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">kubia-gpu</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">nodeSelector</span><span class="pi">:</span>
    <span class="na">gpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span> <span class="c1"># gpu=true 레이블을 포함한 노드에 이 파드라 배포하도록 지시</span>
  <span class="na">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">image</span><span class="pi">:</span> <span class="s">luksa/kubia</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">kubia</span>

</pre></table></code></div></div><h3 id="353-하나의-특정-노드-스케줄링"><span class="mr-2">3.5.3 하나의 특정 노드 스케줄링</span><a href="#353-하나의-특정-노드-스케줄링" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>nodeSelector에 실제 호스트 이름을 지정할 경우 해당 노드가 오프라인 상태인 경우 파드가 스케줄링 되지 않을수 있어서 레이블 셀렉터를 통해 지정한 특정 기준을 만족하는 노드의 논리적인 그룹으로 처리될 수 있도록 해야 한다.<li>추가로 노드에 파드를 스케줄링할 때 영향을 줄수 있는 방법은 16장에서 또 나옴</ul><h2 id="36-파드에-어노테이션-달기"><span class="mr-2">3.6 파드에 어노테이션 달기</span><a href="#36-파드에-어노테이션-달기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>어노테이션은 키-값 쌍으로 레이블과 거의 비슷하지만 식별 정보로 사용되지 않음.<li>반면 훨씬 더 많은 정보를 보유할 수 있다.<li>쿠버네티스 새로운 기능 릴리스시 어노테이션을 사용하곤 한다.<li>어노테이션을 유용하게 사용하는 방법은 파드나 다른 API 오브젝트에 설명을 추가하는 것을 예를 들수 있음.<ul><li>이렇게 하면 클러스터를 사용하는 모든 사람이 개별 오브젝트에 관한 정보를 쉽게 찾을수 있음.</ul></ul><h3 id="361-오브젝트의-어노테이션-조회"><span class="mr-2">3.6.1 오브젝트의 어노테이션 조회</span><a href="#361-오브젝트의-어노테이션-조회" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>레이블에 넣을 데이터는 보통 짧은 데이터이고, 어노테이션에는 상대적으로 큰 데이터를 넣을 수 있음</ul><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c"># kubectl describe {리소스} {name}</span>
kubectl get po kubia-xxxxx <span class="nt">-o</span> yarml  <span class="c"># 1.9부터 이 정보는 yaml안에서 확인할수 없도록 변경됨</span>

</pre></table></code></div></div><h3 id="362-어노테이션-추가-및-수정"><span class="mr-2">3.6.2 어노테이션 추가 및 수정</span><a href="#362-어노테이션-추가-및-수정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># 어노테이션 추가</span>
kubectl annotate pod kubia-manual naver.com/someannotation<span class="o">=</span><span class="s2">"naver foo bar"</span>

<span class="c"># describe을 통해 pod의 어노테이션 정보 조회</span>
kubectl describe pod kubia-manual
</pre></table></code></div></div><h2 id="37-네임스페이스를-사용한-리소스-그룹화"><span class="mr-2">3.7 네임스페이스를 사용한 리소스 그룹화</span><a href="#37-네임스페이스를-사용한-리소스-그룹화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>각 오브젝트는 여러 레이블을 가질 수 있기 때문에 오브젝트 그룹은 서로 겹쳐질 수 있다.<li>클러스터에서 작업을 수행할 때 레이블 셀렉터를 명시적으로 지정하지 않으면 항상 모든 오브젝트를 보게 된다.<li>이런 문제를 해결하기 위해 쿠버네티스는 네임스페이스 단위로 오브젝트를 그룹화한다.<li>docker에서 이야기했던 리눅스 네임스페이스와는 별개임</ul><h3 id="371-네임스페이스의-필요성"><span class="mr-2">3.7.1 네임스페이스의 필요성</span><a href="#371-네임스페이스의-필요성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>네임스페이스를 사용하면 많은 구성 요소를 가진 복잡한 시스템을 좀 더 작은 개별 그룹으로 분리할 수 있음.<li>멀티테넌트환경처럼 리소르르 분리하는 데 사용된다.<li>리소스를 프로덕션 개발, QA환경 혹은 원하는 다른 방법으로 나누어 사용할 수 있다.<li>단 노드의 경우는 전역 리소스이고, 단일 네임스페이스에 얽매이지 않는다.(이러한 이유는 4장에서 다룸)</ul><h3 id="372-다른-네임스페이스와-파드-살펴보기"><span class="mr-2">3.7.2 다른 네임스페이스와 파드 살펴보기</span><a href="#372-다른-네임스페이스와-파드-살펴보기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>명시적으로 지정하지 않았다면 default 네임스페이스를 사용했을 것 ``` sh kubectl get ns</ul><p>kubectl get po -n kube-system</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre> - 쿠베 시스템에 대한 네임스페이스가 분리되어 있어서 뭔가 유저가 만든 리소스들과 깔끔하게 분리하여 관리할수 있음.
 - 매우 큰 규모에서 쿠버네티스를 사용한다면 네임스페이스를 사용해서 서로 관계없는 리소스를 겹치지 않는 그룹으로 분리할 수 있다.
 - 네임스페이스 기준으로 리소스 이름에 관한 접근범위를 제공하므로 리소스 이름 충돌에 대한 걱정도 할 필요 없음.
 - 이 외에도 특정 사용자에 대한 리솟 ㅡ접근 권한을 관리할수도 있고, 개별 사용자가 사용할 수 있는 컴퓨팅 리소스를 제한하는 데에도 사용된다.

### 3.7.3 네임스페이스 생성

``` yaml
apiVersion: v1
kind: Namespace
metadata:
  name: custom-namespace
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># yaml 파일을 이용한 네임스페이스 생성</span>
kubectl create <span class="nt">-f</span> custom-namespace.yaml

<span class="c"># 커맨드라인 명령어로 생성</span>
kubectl create namespace custom-namespace
</pre></table></code></div></div><h3 id="374-다른-네임스페이스의-오브젝트-관리"><span class="mr-2">3.7.4 다른 네임스페이스의 오브젝트 관리</span><a href="#374-다른-네임스페이스의-오브젝트-관리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>생성한 네임스페이스 안에 리소스를 만들기 위해서는 metadata 섹션에 namespace항목을 넣거나 kubectl create 명령시 네임스페이스를 지정하면 된다.</ul><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># custom-namespace에 pod 생성</span>
kubectl create <span class="nt">-f</span> kubia-manual.yaml <span class="nt">-n</span> custom-namespace
</pre></table></code></div></div><ul><li>네임스페이스 context 이동</ul><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># custom-namespace 네임스페이스로 컨텍스트 변경</span>
kubectl config set-context <span class="nt">--current</span> <span class="nt">--namespace</span><span class="o">=</span>custom-namespace

<span class="c"># default 네임스페이스로 컨텍스트 변경</span>
kubectl config set-context <span class="nt">--current</span> <span class="nt">--namespace</span><span class="o">=</span>default
</pre></table></code></div></div><h3 id="375-네임스페이스가-제공하는-격리이해"><span class="mr-2">3.7.5 네임스페이스가 제공하는 격리이해</span><a href="#375-네임스페이스가-제공하는-격리이해" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>실행중인 오브젝트에 대한 격리는 제공하지 않음.<li>네임스페이스에서 네트워크 격리를 제공하는지는 쿠버네티스와 함께 배포하는 네트워킹 솔루션에 따라 다름.<li>서로 다른 네임스페이스 안에 있는 파드끼리 서로 IP주소를 알고있다면 HTTP 요청과 같은 트래픽을 다른 파드로 보내는데에는 전혀 제약이 없다.</ul><h2 id="38-파드-중지와-제거"><span class="mr-2">3.8 파드 중지와 제거</span><a href="#38-파드-중지와-제거" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>파드를 삭제하면 쿠버네티스 파드 안에 있는 모든 컨테이너를 종료하도록 지시<li>이때 SIGTERM 신호를 프로세스에 보내고, 지정된 시간(기본 30초)동안 기다린다.<li>시간 내에 종료되지 않으면 SIGKILL 신호를 통해 종료시킨다.<li>프로세스가 항상 정상적으로 종료되게 하기 위해서는 SIGTERM 신호를 올바르게 처리해야 한다.</ul><h3 id="381-이름으로-파드-제거"><span class="mr-2">3.8.1 이름으로 파드 제거</span><a href="#381-이름으로-파드-제거" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># 이름으로 삭제</span>
kubectl delete po kubia-gpu

<span class="c"># 공백을 구분자로 여러개를 한번에 지울수 있음.</span>
kubectl delete po kubia-gpu kubia-gpu2
</pre></table></code></div></div><h3 id="382-레이블-셀렉터를-이용한-파드-삭제"><span class="mr-2">3.8.2 레이블 셀렉터를 이용한 파드 삭제</span><a href="#382-레이블-셀렉터를-이용한-파드-삭제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c"># 레이블 셀렉터를 이요한 삭제</span>
kubectl delete po <span class="nt">-l</span> <span class="nv">creation_method</span><span class="o">=</span>manual
kubectl delete po <span class="nt">-l</span> <span class="nv">rel</span><span class="o">=</span>canary
</pre></table></code></div></div><h3 id="383-네임스페이스를-삭제한-파드-제거"><span class="mr-2">3.8.3 네임스페이스를 삭제한 파드 제거</span><a href="#383-네임스페이스를-삭제한-파드-제거" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl delete ns custom-namespace
</pre></table></code></div></div><h3 id="384-네임스페이슬-유지하면서-네임스페이스-안에-모든-파드-삭제"><span class="mr-2">3.8.4 네임스페이슬 유지하면서 네임스페이스 안에 모든 파드 삭제</span><a href="#384-네임스페이슬-유지하면서-네임스페이스-안에-모든-파드-삭제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>여기서 파드를 삭제하더라도 레플리케이션컨트롤러로 생긴 파드가 있었다면 삭제하더라도 다시 스케줄링 될것(이 경우 파드를 삭제하기 위해서는 리플리케이션컨트롤러도 같이 삭제해야 한다.<div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl delete po <span class="nt">--all</span>
</pre></table></code></div></div></ul><h3 id="385-네임스페이스에서-거의-모든-리소스-삭제"><span class="mr-2">3.8.5 네임스페이스에서 (거의) 모든 리소스 삭제</span><a href="#385-네임스페이스에서-거의-모든-리소스-삭제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>all 키워드를 쓰면 대부분의 리소스는 삭제할 수 있지만, 7장에 나올 시크릿 같은 특정 리소스는 그대로 보존되어 있다.<li>이 키워드를 통해 kubernetes 서비스도 삭제가 가능하지만 잠시 후에 다시 생성된다.<div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>kubectl delete all <span class="nt">--all</span>
</pre></table></code></div></div></ul><h2 id="39-요약"><span class="mr-2">3.9 요약</span><a href="#39-요약" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>특정 컨테이너를 파드로 묶어야 하는지 여부를 결정하는 방법<li>파드는 여러 프로세스를 실행할 수 있으며 컨테이너가 아닌 세계의 물리적 호스트와 비슷하다.<li>yaml 또는 json 디스크립터를 작성해 파드를 작성하고 파드 정의와 상태를 확인할 수 있다.<li>레이블과 레이블 셀렉터를 사용해 파드를 조직하고 한번에 여러 파드에서 작업을 쉽게 수행할 수 있다.<li>노드 레이블과 셀렉터를 사용해 특정 기능을 가진 노드에 파드를 스케줄링 할 수 있다.<li>어노테이션을 사용하면 사람 또는 도구, 라이브러리에서 더 큰 데이터를 파드에 부착할 수 있다.<li>네임스페이스는 다른 팀들이 동일한 클러스터를 별도 클러스터를 사용하는 것처럼 이용할 수 있게 해준다.<li>kubectl explain 명령으로 쿠버네티스 리소스 도움말을 볼 수 있음.</ul><h2 id="reference"><span class="mr-2">Reference</span><a href="#reference" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://www.manning.com/books/kubernetes-in-action">kubernetes-in-action</a><li><a href="https://kubernetes.io/ko/docs/home/">kubernetes.io</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/devlog/'>DevLog</a>, <a href='/categories/kubernetes/'>kubernetes</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/infra/" class="post-tag no-text-decoration" >Infra</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a> <a href="/tags/kubernetes-in-action/" class="post-tag no-text-decoration" >kubernetes-in-action</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[kubernetes-in-action]%203.%20%ED%8C%8C%EB%93%9C%20:%20%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%97%90%EC%84%9C%20%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%20%EC%8B%A4%ED%96%89%20-%20Sungsu's%20Tech%20Blog&url=https%3A%2F%2Fsungsu9022.github.io%2Fposts%2Fdevlog-platform-kubernetes-in-action3%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[kubernetes-in-action]%203.%20%ED%8C%8C%EB%93%9C%20:%20%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%97%90%EC%84%9C%20%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%20%EC%8B%A4%ED%96%89%20-%20Sungsu's%20Tech%20Blog&u=https%3A%2F%2Fsungsu9022.github.io%2Fposts%2Fdevlog-platform-kubernetes-in-action3%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fsungsu9022.github.io%2Fposts%2Fdevlog-platform-kubernetes-in-action3%2F&text=[kubernetes-in-action]%203.%20%ED%8C%8C%EB%93%9C%20:%20%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%97%90%EC%84%9C%20%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%20%EC%8B%A4%ED%96%89%20-%20Sungsu's%20Tech%20Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/es-bible-4-3/">[엘라스틱서치 바이블] 4. 데이터 다루기 -3(ES Client 라이브러리)</a><li><a href="/posts/es-bible-4-2/">[엘라스틱서치 바이블] 4. 데이터 다루기 -2(집계)</a><li><a href="/posts/es-bible-2/">[엘라스틱서치 바이블] 2. 엘라스틱 서치 기본 동작과 구조</a><li><a href="/posts/es-bible-3-1/">[엘라스틱서치 바이블] 3. 인덱스 설계 - 1</a><li><a href="/posts/spark-guide-6/">[스파크 완벽 가이드] 6. 다양한 데이터 타입 다루기</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spark/">Spark</a> <a class="post-tag" href="/tags/infra/">Infra</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/kubernetes-in-action/">kubernetes-in-action</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/elasticsearch/">Elasticsearch</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/hands-on-reactive-programming-in-spring-5/">Hands-On Reactive Programming in Spring 5</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/devlog-platform-kubernetes-in-action1/"><div class="card-body"> <em class="small" data-ts="1596270840" data-df="ll" > Aug 1, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[kubernetes-in-action] 1. 쿠버네티스 소개</h3><div class="text-muted small"><p> 1. 쿠버네티스 소개 쿠버네티스 등장 배경 거대한 모놀리스 레거시 애플리케이션은 점차 마이크로 서비스라는 독립적으로 실행되는 더 작은 구성 요소로 세분화되고 있다. 마이크로 서비스는 서루 분리돼 있기 떄문에 개별적으로 개발, 배포, 업데이트, 확장할 수 있다. 이로써 오늘날 급변하는 비즈니스 요구사항을 충족시킬 만큼 신속하게 자주 구성 요소를 변...</p></div></div></a></div><div class="card"> <a href="/posts/devlog-platform-kubernetes-in-action2/"><div class="card-body"> <em class="small" data-ts="1596357240" data-df="ll" > Aug 2, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[kubernetes-in-action] 2. 도커와 쿠버네티스 첫걸음</h3><div class="text-muted small"><p> 2. 도커와 쿠버네티스 첫걸음 2.1 도커를 사용한 컨테이너 이미지 생성, 실행, 공유하기 2.1.1 Hello World 컨테이너 실행하기 docker run busybox echp &quot;Hello world&quot; 백그라운드에 일어난 동작 이해하기 docker run 명령을 수행했을 떄 일어나는 일들 2.1.2 간단한 node.js 애플리...</p></div></div></a></div><div class="card"> <a href="/posts/devlog-platform-kubernetes-in-action4/"><div class="card-body"> <em class="small" data-ts="1596789240" data-df="ll" > Aug 7, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[kubernetes-in-action] 4. 레플리케이션과 그 밖의 컨트롤러 : 관리되는 파드 배포</h3><div class="text-muted small"><p> 4. 레플리케이션과 그 밖의 컨트롤러 : 관리되는 파드 배포 4.1 파드를 안정적으로 유지하기 쿠버네티스를 사용하면 얻을 수 있는 주요 이점은 쿠버네티스에 컨테이너 목록을 제공하면 해당 컨테이너를 클러스터 어딘가에서 계속 실행되도록 할수 있는 것이다. 파드가 노드에 스케줄링되면 노드의 Kubelet은 이 파드가 존재하는 한 컨테이너가 계속 실...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/devlog-platform-kubernetes-in-action2/" class="btn btn-outline-primary" prompt="Older"><p>[kubernetes-in-action] 2. 도커와 쿠버네티스 첫걸음</p></a> <a href="/posts/devlog-platform-kubernetes-in-action4/" class="btn btn-outline-primary" prompt="Newer"><p>[kubernetes-in-action] 4. 레플리케이션과 그 밖의 컨트롤러 : 관리되는 파드 배포</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://sungsu9022.github.io/posts/devlog-platform-kubernetes-in-action3/'; this.page.identifier = '/posts/devlog-platform-kubernetes-in-action3/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver( function (entries) { if (entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://sungsu-parks-tech-blog.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] } ); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* Disqus hasn't been loaded */ if (typeof DISQUS === 'undefined') { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } } if (document.querySelector('.mode-toggle')) { window.addEventListener('message', reloadDisqus); } </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spark/">Spark</a> <a class="post-tag" href="/tags/infra/">Infra</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/kubernetes-in-action/">kubernetes-in-action</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/elasticsearch/">Elasticsearch</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/hands-on-reactive-programming-in-spring-5/">Hands-On Reactive Programming in Spring 5</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/sungsu9022dev">sungsu9022</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-145894105-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-145894105-1'); }); </script>
