<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="[스파크 완벽 가이드] 16. 스파크 애플리케이션 개발하기" /><meta name="author" content="sungsu park" /><meta property="og:locale" content="en" /><meta name="description" content="[스파크 완벽 가이드] 16. 스파크 애플리케이션 개발하기" /><meta property="og:description" content="[스파크 완벽 가이드] 16. 스파크 애플리케이션 개발하기" /><link rel="canonical" href="https://sungsu9022.github.io/posts/spark-guide-16/" /><meta property="og:url" content="https://sungsu9022.github.io/posts/spark-guide-16/" /><meta property="og:site_name" content="Sungsu’s Tech Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-04T20:10:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[스파크 완벽 가이드] 16. 스파크 애플리케이션 개발하기" /><meta name="twitter:site" content="@sungsu9022dev" /><meta name="twitter:creator" content="@sungsu park" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"sungsu park"},"dateModified":"2023-02-04T20:10:00+09:00","datePublished":"2023-02-04T20:10:00+09:00","description":"[스파크 완벽 가이드] 16. 스파크 애플리케이션 개발하기","headline":"[스파크 완벽 가이드] 16. 스파크 애플리케이션 개발하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://sungsu9022.github.io/posts/spark-guide-16/"},"url":"https://sungsu9022.github.io/posts/spark-guide-16/"}</script><title>[스파크 완벽 가이드] 16. 스파크 애플리케이션 개발하기 | Sungsu's Tech Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Sungsu's Tech Blog"><meta name="application-name" content="Sungsu's Tech Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/personal/sunny.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Sungsu's Tech Blog</a></div><div class="site-subtitle font-italic">Java/Kotlin Spring, Back-end</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/sungsu9022" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/sungsu9022dev" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['sungsu9022','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[스파크 완벽 가이드] 16. 스파크 애플리케이션 개발하기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[스파크 완벽 가이드] 16. 스파크 애플리케이션 개발하기</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1675509000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 4, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2887 words"> <em>16 min</em> read</span></div></div></div><div class="post-content"><h1 id="스파크-완벽-가이드-16-스파크-애플리케이션-개발하기">[스파크 완벽 가이드] 16. 스파크 애플리케이션 개발하기</h1><h2 id="161-스파크-애플리케이션-작성하기"><span class="mr-2">16.1 스파크 애플리케이션 작성하기</span><a href="#161-스파크-애플리케이션-작성하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>스파크 애플리케이션은 스파크 클러스터와 사용자 코드 2가지 조합으로 구성된다.</ul><h3 id="1611-간단한-스칼라-기반-앱"><span class="mr-2">16.1.1 간단한 스칼라 기반 앱</span><a href="#1611-간단한-스칼라-기반-앱" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>스칼라는 스파크의 기본 언어이기 때문에 이를 개발하는 가장 적합한 방법이라 볼 수 있다.<ul><li>다만 실무에서 airflow를 이용해 스케줄링이 가능한 파이프라인 구축시에는 python을 가장 많이 사용하는듯 하다.</ul></ul><div class="language-scala highlighter-rouge"><div class="code-header"> <span data-label-text="Scala"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">object</span> <span class="nc">DataFrameExample</span> <span class="k">extends</span> <span class="nc">Serializable</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span> <span class="k">=</span> <span class="o">{</span>

    <span class="k">val</span> <span class="nv">spark</span> <span class="k">=</span> <span class="nc">SparkSession</span>
      <span class="o">.</span><span class="py">builder</span><span class="o">()</span>
      <span class="o">.</span><span class="py">appName</span><span class="o">(</span><span class="s">"Databricks Spark Example"</span><span class="o">)</span>
      <span class="o">.</span><span class="py">config</span><span class="o">(</span><span class="s">"spark.sql.warehouse.dir"</span><span class="o">,</span> <span class="s">"/user/hive/warehouse"</span><span class="o">)</span>
      <span class="o">.</span><span class="py">getOrCreate</span><span class="o">()</span>
    <span class="k">import</span> <span class="nn">spark.implicits._</span>

    <span class="nv">spark</span><span class="o">.</span><span class="py">udf</span><span class="o">.</span><span class="py">register</span><span class="o">(</span><span class="s">"pointlessUDF"</span><span class="o">,</span> <span class="nv">DFUtils</span><span class="o">.</span><span class="py">pointlessUDF</span><span class="o">(</span><span class="k">_:</span><span class="kt">String</span><span class="o">)</span><span class="k">:</span><span class="kt">String</span><span class="o">)</span>

    <span class="k">val</span> <span class="nv">authors</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">"bill,databricks"</span><span class="o">,</span> <span class="s">"matei,databricks"</span><span class="o">)</span>
    <span class="k">val</span> <span class="nv">authorsDF</span> <span class="k">=</span> <span class="n">spark</span>
      <span class="o">.</span><span class="py">sparkContext</span>
      <span class="o">.</span><span class="py">parallelize</span><span class="o">(</span><span class="n">authors</span><span class="o">)</span>
      <span class="o">.</span><span class="py">toDF</span><span class="o">(</span><span class="s">"raw"</span><span class="o">)</span>
      <span class="o">.</span><span class="py">selectExpr</span><span class="o">(</span><span class="s">"split(raw, ',') as values"</span><span class="o">)</span>
      <span class="o">.</span><span class="py">selectExpr</span><span class="o">(</span><span class="s">"pointlessUDF(values[0]) as name"</span><span class="o">,</span> <span class="s">"values[1] as company"</span><span class="o">)</span>
      <span class="o">.</span><span class="py">show</span><span class="o">()</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>위와 같은 예제 코드가 있다고했을떄 이를 실행하기 위해 빌드를 우선해야 한다.<li>JVM 언어를 빌드하기 위한 도구는 gradle, maven, sbt 등 다양한 방법이 있으나 여기서는 생략하도록 한다.</ul><h4 id="애플리케이션-실행하기"><span class="mr-2">애플리케이션 실행하기</span><a href="#애플리케이션-실행하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>빌드된 jar파일을 <code class="language-plaintext highlighter-rouge">spark-submit</code>에 파라미터로 지정하여 앱을 실행할 수 있다.</ul><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$SPARK_HOME</span>/bin/spark-submit <span class="nt">--class</span> com.databricks.example.DataFrameExample <span class="nt">--master</span> <span class="nb">local </span>target/scala-2.11/example_2.11-0.1-SNAPSHOT.jar <span class="s2">"hello"</span>
</pre></table></code></div></div><h3 id="1612-파이썬-애플리케이션-작성하기"><span class="mr-2">16.1.2 파이썬 애플리케이션 작성하기</span><a href="#1612-파이썬-애플리케이션-작성하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>PySpark 애플리케이션을 작성하는 방법은 일반 파이썬 애플리케이션이나 패키지를 작성하는 방법과 거의 비슷하다.<li>파이썬에서는 빌드 개념이 없고, 일반 스크립트를 작성하는것에 지나지 않는다.</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="kn">from</span> <span class="n">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
    <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="p">.</span><span class="n">builder</span> \
        <span class="p">.</span><span class="nf">master</span><span class="p">(</span><span class="sh">"</span><span class="s">local</span><span class="sh">"</span><span class="p">)</span> \
        <span class="p">.</span><span class="nf">appName</span><span class="p">(</span><span class="sh">"</span><span class="s">Word Count</span><span class="sh">"</span><span class="p">)</span> \
        <span class="p">.</span><span class="nf">config</span><span class="p">(</span><span class="sh">"</span><span class="s">spark.some.config.option</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">some-value</span><span class="sh">"</span><span class="p">)</span> \
        <span class="p">.</span><span class="nf">getOrCreate</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="n">spark</span><span class="p">.</span><span class="nf">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">).</span><span class="nf">where</span><span class="p">(</span><span class="sh">"</span><span class="s">id &gt; 500</span><span class="sh">"</span><span class="p">).</span><span class="nf">selectExpr</span><span class="p">(</span><span class="sh">"</span><span class="s">sum(id)</span><span class="sh">"</span><span class="p">).</span><span class="nf">collect</span><span class="p">())</span>

</pre></table></code></div></div><ul><li>위 코드가 실행되면 애플리케이션에서 활용할 수 있는 SparkSession 객체가 생성된다.<ul><li>권장 방법은 모든 파이썬 클래스에서 SparkSession 객체를 생성하는 것보다 런타임 환경에서는 변수를 생성해 파이썬 클래스에 전달하는 방식을 사용하는것이 더 좋다.</ul></ul><h4 id="애플리케이션-실행하기-1"><span class="mr-2">애플리케이션 실행하기</span><a href="#애플리케이션-실행하기-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$SPARK_HOME</span>/bin/spark-submit <span class="nt">-master</span> <span class="nb">local </span>pyspark/template/amin.py
</pre></table></code></div></div><h3 id="1613-자바-애플리케이션-작성하기"><span class="mr-2">16.1.3 자바 애플리케이션 작성하기</span><a href="#1613-자바-애플리케이션-작성하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>스파크와 거의 유사하다.</ul><h2 id="162-스파크-애플리케이션-테스트"><span class="mr-2">16.2 스파크 애플리케이션 테스트</span><a href="#162-스파크-애플리케이션-테스트" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>약간 지루하지만 아주 중요한 주제인 테스트 방법을 알아보겠습니다.<li>스파크 앱을 테스트하려면 작성시 몇가지 핵심 원칙과 구성 전략을 고려해야 한다.</ul><h3 id="1621-전략적-원칙"><span class="mr-2">16.2.1 전략적 원칙</span><a href="#1621-전략적-원칙" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>데이터 파이프라인과 앱에 대한 테스트 코드 개발은 실제 애플리케이션 개발만큼이나 중요하다.<li>테스트 코드는 미래에 발생할 수 있는 데이터, 로직 그리고 결과 변환에 유연하게 대처할 수 있게 도와준다.</ul><h4 id="입력-데이터에-대한-유연성"><span class="mr-2">입력 데이터에 대한 유연성</span><a href="#입력-데이터에-대한-유연성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>데이터 파이프라인은 다양한 유형의 입력 데이터에 유연하게 대처할 수 있어야 한다.<li>비즈니스 요구사항이 변하면 데이터도 변한다.<li>스파크 앱과 파이프라인은 입력 데이터 중 일부가 변하더라도 유연하게 대처할 수 있어야 한다.<li>입력 데이터 변화로 발생할 수 있는 다양한 예외 상항을 테스트하는 코드를 작성해야 한다.</ul><h4 id="비즈니스-로직-변경에-대한-유연성"><span class="mr-2">비즈니스 로직 변경에 대한 유연성</span><a href="#비즈니스-로직-변경에-대한-유연성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>예상했던 원형 데이터의 형태가 실제 원형 데이터와 같은지 확인하고 싶은 경우, 원하는 결과를 얻을 수 있도록 실제와 유사한 데이터를 사용해 비즈니스 로직을 꼼꼼하게 테스트해야 한다.<li>이 유형의 테스트에서는 스파크의 고유 기능에 대한 단위 테스트를 작성하지 말고, 비즈니스 로직을 테스트해서 복잡한 비즈니스 파이프라인이 의도한 대로 동작하는지를 검증해야 한다.</ul><h4 id="결과의-유연성과-원자성"><span class="mr-2">결과의 유연성과 원자성</span><a href="#결과의-유연성과-원자성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>입력 데이터 및 비즈니스 로직의 테스트가 완료되었다면 결과가 의도한 대로 반환되느지 확인해야 한다.<li>데이터가 얼마나 자주 갱신되는지, 데이터가 완벽한지(늦게 들어온 데이터가 없는지), 마지막 순간에 데이터가 변경되지 않았는지 등을 이해할 수 있도록 만들어야 한다.</ul><h3 id="1622-테스트-코드-작성시-고려사항"><span class="mr-2">16.2.2 테스트 코드 작성시 고려사항</span><a href="#1622-테스트-코드-작성시-고려사항" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>적절한 단위 테스트를 작성해 입력 데이터나 구조가 변경되어도 비즈니스 로직이 정상적으로 동작하는지 확인 해야 한다.<li>단위 테스트를 하면 스키마 변경되는 상황에 쉽게 대응할 수 있다.</ul><h4 id="sparksession-관리하기"><span class="mr-2">SparkSession 관리하기</span><a href="#sparksession-관리하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>스파크 로컬 모드 덕분에 단위 테스트용 프레임워크로 비교적 쉽게 스파크 코드를 테스트할 수 있다.<li>단위 테스트에서는 의존성 주입 방식으로 SparkSession이 관리하도록 만들어주면 된다.<ul><li>런타임에 적절히 SparkSession을 전달해주는 방식으로 코드 작성</ul></ul><h4 id="테스트-코드용-스파크-api-선정하기"><span class="mr-2">테스트 코드용 스파크 API 선정하기</span><a href="#테스트-코드용-스파크-api-선정하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>SQL, DataFrame, Dataset 다양한 API 중 유지보수성, 테스트 용이성 측면에서 적절히 검토한 후 팀의 니즈에 맞게 선정하여야 한다.<li>API 유형에 관계없이 함수의 입/출력(함수 시그니처)을 정의하면 추후 이런 변경에 유연하게 대응할 수 있다.</ul><h3 id="1623-단위-테스트-프레임워크에-연결하기"><span class="mr-2">16.2.3 단위 테스트 프레임워크에 연결하기</span><a href="#1623-단위-테스트-프레임워크에-연결하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>테스트마다 SparkSession을 생성하고 제거하도록 설정하는 것이 좋다.<ul><li>JUnit의 <code class="language-plaintext highlighter-rouge">@Before</code>, <code class="language-plaintext highlighter-rouge">@After</code> 애노테이션과 같은 것을 활용</ul></ul><h3 id="1624-데이터소스-연결하기"><span class="mr-2">16.2.4 데이터소스 연결하기</span><a href="#1624-데이터소스-연결하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>테스트 코드에서는 운영 환경의 데이터소스에 접속하지 않도록 해야 한다.<ul><li>로컬 환경에 Docker를 이용해 별도 데이터 소스를 연결해서 처리할수 있도록 하거나 h2 in-memory db 같은것을 활용할 수 있음</ul></ul><h2 id="163-개발-프로세스"><span class="mr-2">16.3 개발 프로세스</span><a href="#163-개발-프로세스" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>스파크 애플리케이션의 개발에서도 기존에 삳용하던 개발 흐름과 유사하다.<li>대화형 노트북이나 유사한 환경에 치고화된 작업 공간을 마련한다.(Zeppline)<li>그리고 핵심 컴포넌트와 알고리즘을 만든 후에 영구적인 영역으로 코드를 옮긴다.<li>로컬 머신에서 <code class="language-plaintext highlighter-rouge">spark-shell</code>과 같은 것을 사용할 수도 있다.</ul><h2 id="164-애플리케이션-시작하기"><span class="mr-2">16.4 애플리케이션 시작하기</span><a href="#164-애플리케이션-시작하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><code class="language-plaintext highlighter-rouge">spark-submit</code> 명령을 실행하고, 잡 제출시 클라이언트 모드 혹은 클러스터 모드를 선택해서 실행할 수 있다.</ul><h3 id="spark-submit-도움말"><span class="mr-2"><code class="language-plaintext highlighter-rouge">spark-submit</code> 도움말</span><a href="#spark-submit-도움말" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://user-images.githubusercontent.com/6982740/216812285-a689aca6-1053-4da8-8341-de26144faf19.png" class="popup img-link "><img width="640" alt="스크린샷 2023-02-05 오후 6 52 31" data-src="https://user-images.githubusercontent.com/6982740/216812285-a689aca6-1053-4da8-8341-de26144faf19.png" class="lazyload" data-proofer-ignore></a></p><p><a href="https://user-images.githubusercontent.com/6982740/216812297-3ad12f76-26b8-42c5-aded-c39351fa18b5.png" class="popup img-link "><img width="640" alt="스크린샷 2023-02-05 오후 6 52 49" data-src="https://user-images.githubusercontent.com/6982740/216812297-3ad12f76-26b8-42c5-aded-c39351fa18b5.png" class="lazyload" data-proofer-ignore></a></p><h3 id="배포-환경별-설정"><span class="mr-2">배포 환경별 설정</span><a href="#배포-환경별-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://user-images.githubusercontent.com/6982740/216812306-84bf3266-7fdb-4dd0-beda-4e18f46fbb0c.png" class="popup img-link "><img width="633" alt="스크린샷 2023-02-05 오후 6 53 12" data-src="https://user-images.githubusercontent.com/6982740/216812306-84bf3266-7fdb-4dd0-beda-4e18f46fbb0c.png" class="lazyload" data-proofer-ignore></a></p><p><a href="https://user-images.githubusercontent.com/6982740/216812314-4919fe89-db4a-4fd0-9e6a-6a3cdd0312bd.png" class="popup img-link "><img width="633" alt="스크린샷 2023-02-05 오후 6 53 19" data-src="https://user-images.githubusercontent.com/6982740/216812314-4919fe89-db4a-4fd0-9e6a-6a3cdd0312bd.png" class="lazyload" data-proofer-ignore></a></p><h3 id="1641-애플리케이션-시작-예제"><span class="mr-2">16.4.1 애플리케이션 시작 예제</span><a href="#1641-애플리케이션-시작-예제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>/bin/spark-submit
  <span class="nt">--class</span> org.apache.spark.examples.SparkPi
  <span class="nt">--master</span> spark://207.184.161.138:7077
  <span class="nt">--executor-memory</span> 206
  <span class="nt">--total-executor-cores</span> 100
  replace/with/path/to/examples.jar 1000


/bin/spark-submit
  <span class="nt">--master</span> spark://207.184.161.138:7077
  examples/src/main/python/pi.py
</pre></table></code></div></div><ul><li>master 옵션의 값을 local이나 <code class="language-plaintext highlighter-rouge">local[*]</code>로 변경하면 애플리케이션 로컬 모드를 실행할 수 있다.</ul><h2 id="165-애플리케이션-환경-설정하기"><span class="mr-2">16.5 애플리케이션 환경 설정하기</span><a href="#165-애플리케이션-환경-설정하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>목적에 따라 다양한 환경을 설정할 수 있다.</ul><blockquote><p>애플리케이션 속성 런타임 환경 셔플 동작 방식 스파크 UI 압축과 직렬화 메모리 관리 처리 방식 네트워크 설정 스케줄링 동적할당 보안 암호화 스파크 SQL 스파크 스트리밍 SparkR</p></blockquote><h3 id="설정-방식"><span class="mr-2">설정 방식</span><a href="#설정-방식" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>스파크 속성은 대부분 애플리케이션 파라미터를 제어하며, SparkConf 객체를 사용해 스파크 속성을 설정할 수 있다.<li>자바 시스템 Property<li>하드코딩된 환경 설정 파일</ul><h3 id="1651-sparkconf"><span class="mr-2">16.5.1 SparkConf</span><a href="#1651-sparkconf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-scala highlighter-rouge"><div class="code-header"> <span data-label-text="Scala"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nn">org.apache.spark.SparkConf</span>

<span class="k">val</span> <span class="nv">conf</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">SparkConf</span><span class="o">().</span><span class="py">setMaster</span><span class="o">(</span><span class="s">"local[2]"</span><span class="o">).</span><span class="py">setAppName</span><span class="o">(</span><span class="s">"DefinitiveGuide"</span><span class="o">)</span>
  <span class="o">.</span><span class="py">set</span><span class="o">(</span><span class="s">"some.conf"</span><span class="o">,</span> <span class="s">"to.some.value"</span><span class="o">)</span>
</pre></table></code></div></div><ul><li>SparkConf 객체는 개별 스파크 애플리케이션에 대한 스파크 속성값을 구성하는 용도로 사용한다.<li>애플리케이션의 동작 방식과 클러스터 구성 방식을 제어한다.<li>명령행 파라미터를 통해 런타임에 구성할 수 있다.</ul><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/bin/spark.submit <span class="nt">--name</span> <span class="s2">"DefinitiveGuide"</span> <span class="nt">--master</span> <span class="nb">local</span><span class="o">[</span>4]
</pre></table></code></div></div><h4 id="시간-주기-형태-속성값포맷"><span class="mr-2">시간 주기 형태 속성값(포맷)</span><a href="#시간-주기-형태-속성값포맷" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><blockquote><p>25ms, 5s, 10m or 10min, 3h, 5d, 1y</p></blockquote><h3 id="1652-애플리케이션-속성"><span class="mr-2">16.5.2 애플리케이션 속성</span><a href="#1652-애플리케이션-속성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://user-images.githubusercontent.com/6982740/216812644-daeaa031-ad18-4d6f-a35a-f42e32fef8d8.png" class="popup img-link "><img width="637" alt="스크린샷 2023-02-05 오후 7 01 47" data-src="https://user-images.githubusercontent.com/6982740/216812644-daeaa031-ad18-4d6f-a35a-f42e32fef8d8.png" class="lazyload" data-proofer-ignore></a></p><p><a href="https://user-images.githubusercontent.com/6982740/216812655-1aa4fd9b-aab2-4c34-b1bb-6b5712530fbc.png" class="popup img-link "><img width="637" alt="스크린샷 2023-02-05 오후 7 01 59" data-src="https://user-images.githubusercontent.com/6982740/216812655-1aa4fd9b-aab2-4c34-b1bb-6b5712530fbc.png" class="lazyload" data-proofer-ignore></a></p><p><a href="https://user-images.githubusercontent.com/6982740/216812670-aeee3173-f0ae-4656-aa67-55edc56e6c27.png" class="popup img-link "><img width="637" alt="스크린샷 2023-02-05 오후 7 02 17" data-src="https://user-images.githubusercontent.com/6982740/216812670-aeee3173-f0ae-4656-aa67-55edc56e6c27.png" class="lazyload" data-proofer-ignore></a></p><h3 id="1653-런타임-속성"><span class="mr-2">16.5.3 런타임 속성</span><a href="#1653-런타임-속성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>드물지만 애플리케이션의 런타임 환경을 설정해야 할수도 있다.<li>관련 속성을 사용해 드라이버와 익스큐터를 위한 추가 클래스트패스와 파이썬패스, 파이썬 워커 설정, 다양한 로그 관련 속성을 정의할 수 있다.<li>자세한 내용은 공식 문서 참고</ul><h3 id="1654-실행-속성"><span class="mr-2">16.5.4 실행 속성</span><a href="#1654-실행-속성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>실행 속성과 관련된 설정값은 실제 처리를 더욱 세밀하게 제어할 수 있기 때문에 자주 사용된다.<li><code class="language-plaintext highlighter-rouge">spark.executor.cores</code>(익스큐터의 코어수)<li><code class="language-plaintext highlighter-rouge">spark.files.maxPartitionsBytes</code> (파일 읽기 시 파티션의 최대크기)</ul><h3 id="1655-메로리-관리-설정"><span class="mr-2">16.5.5 메로리 관리 설정</span><a href="#1655-메로리-관리-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>앱 최적화를 위해 메모리 옵션을 수동으로 관리해야 하는 경우도 있다.<li>대다수의 메모리 설정은 메모리 자동 관리 기능의 추가로 인해 스파크 2.x 버전에서는 제거된 예전 개념이기는 하다.<li>세밀한 제어를 위한 설정이기 때문에 실제로 사용자는 이를 신경쓰지 않아도 된다.</ul><h3 id="1656-셔플-동작방식-설정"><span class="mr-2">16.5.6 셔플 동작방식 설정</span><a href="#1656-셔플-동작방식-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>셔플 동작 방식을 제어하기 위한 고급 설정이 존재한다는 점까지만 참고하라.</ul><h3 id="1657-환경변수"><span class="mr-2">16.5.7 환경변수</span><a href="#1657-환경변수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>스파크가 설치된 디렉터리의 <code class="language-plaintext highlighter-rouge">conf/spark-env.sh</code> 파일에서 읽은 환경변수로 특정 스파크 설정을 구성할 수 있다.</ul><p><a href="https://user-images.githubusercontent.com/6982740/216812874-d22b0efc-c5a1-482c-a645-beb2f9883c43.png" class="popup img-link "><img width="610" alt="스크린샷 2023-02-05 오후 7 07 03" data-src="https://user-images.githubusercontent.com/6982740/216812874-d22b0efc-c5a1-482c-a645-beb2f9883c43.png" class="lazyload" data-proofer-ignore></a></p><p><a href="https://user-images.githubusercontent.com/6982740/216812883-18897a42-7831-4764-b9e7-1e12a95adcd6.png" class="popup img-link "><img width="610" alt="스크린샷 2023-02-05 오후 7 07 11" data-src="https://user-images.githubusercontent.com/6982740/216812883-18897a42-7831-4764-b9e7-1e12a95adcd6.png" class="lazyload" data-proofer-ignore></a></p><ul><li>위 목록 외에도 각 머신이 사용할 코어 수나 최대 메모리 크기 같은 스파크 스탠드얼론 클러스터 설정과 관련된 옵션 등이 있다.</ul><h3 id="1658-애플리케이션에서-잡-스케줄링"><span class="mr-2">16.5.8 애플리케이션에서 잡 스케줄링</span><a href="#1658-애플리케이션에서-잡-스케줄링" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>별도의 스레드를 사용해 여러 잡을 동시에 실행할 수 있다.<li>스파크의 스케줄러는 스레드 안정성을 보장하고, 여러 요청을 동시에 처리할 수 있는 애플리케이션으로 만들어 줄수 있다.<li>여러 스파크 잡이 자원을 공평하게 나눠 쓰도록 구성할 수도 있다.</ul><h4 id="페어-스케줄러"><span class="mr-2">페어 스케줄러</span><a href="#페어-스케줄러" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>SparkContext 설정시 <code class="language-plaintext highlighter-rouge">spark.scheduler.mode</code> 속성을 <code class="language-plaintext highlighter-rouge">FAIR</code>로 지정해서 사용할 수 있다.<li>여러 개의 잡을 풀로 그룹화하는 방식도 지원한다.<li>개별 풀에 다른 스케줄링 옵션이나 가중치를 설정할 수 있다.<li>더 중요한 스파크 잡을 할당할 수 있도록 우선순위가 높은 풀을 만들수 있음.<li>하둡의 페어 스케줄러 모델을 본떠서 만들었음.</ul><h2 id="reference"><span class="mr-2">Reference</span><a href="#reference" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://www.coupang.com/vp/products/164359777?itemId=471497435&amp;vendorItemId=4215695264&amp;src=1042503&amp;spec=10304982&amp;addtag=400&amp;ctag=164359777&amp;lptag=10304982I471497435&amp;itime=20221030164504&amp;pageType=PRODUCT&amp;pageValue=164359777&amp;wPcid=16589055075836517214634&amp;wRef=&amp;wTime=20221030164504&amp;redirect=landing&amp;gclid=Cj0KCQjwwfiaBhC7ARIsAGvcPe7kxytxjJU9Ylxpe5l8Jk9zhXhknDFceRzD80Zn6IzxUaF-RPn5OKAaAnGxEALw_wcB&amp;campaignid=18626086777&amp;adgroupid=">Spark 완벽 가이드</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/devlog/'>DevLog</a>, <a href='/categories/spark/'>Spark</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/spark/" class="post-tag no-text-decoration" >Spark</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[%EC%8A%A4%ED%8C%8C%ED%81%AC%20%EC%99%84%EB%B2%BD%20%EA%B0%80%EC%9D%B4%EB%93%9C]%2016.%20%EC%8A%A4%ED%8C%8C%ED%81%AC%20%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%20%EA%B0%9C%EB%B0%9C%ED%95%98%EA%B8%B0%20-%20Sungsu's%20Tech%20Blog&url=https%3A%2F%2Fsungsu9022.github.io%2Fposts%2Fspark-guide-16%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[%EC%8A%A4%ED%8C%8C%ED%81%AC%20%EC%99%84%EB%B2%BD%20%EA%B0%80%EC%9D%B4%EB%93%9C]%2016.%20%EC%8A%A4%ED%8C%8C%ED%81%AC%20%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%20%EA%B0%9C%EB%B0%9C%ED%95%98%EA%B8%B0%20-%20Sungsu's%20Tech%20Blog&u=https%3A%2F%2Fsungsu9022.github.io%2Fposts%2Fspark-guide-16%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fsungsu9022.github.io%2Fposts%2Fspark-guide-16%2F&text=[%EC%8A%A4%ED%8C%8C%ED%81%AC%20%EC%99%84%EB%B2%BD%20%EA%B0%80%EC%9D%B4%EB%93%9C]%2016.%20%EC%8A%A4%ED%8C%8C%ED%81%AC%20%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%20%EA%B0%9C%EB%B0%9C%ED%95%98%EA%B8%B0%20-%20Sungsu's%20Tech%20Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/es-bible-4-3/">[엘라스틱서치 바이블] 4. 데이터 다루기 -3(ES Client 라이브러리)</a><li><a href="/posts/es-bible-4-2/">[엘라스틱서치 바이블] 4. 데이터 다루기 -2(집계)</a><li><a href="/posts/es-bible-2/">[엘라스틱서치 바이블] 2. 엘라스틱 서치 기본 동작과 구조</a><li><a href="/posts/es-bible-3-1/">[엘라스틱서치 바이블] 3. 인덱스 설계 - 1</a><li><a href="/posts/spark-guide-6/">[스파크 완벽 가이드] 6. 다양한 데이터 타입 다루기</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spark/">Spark</a> <a class="post-tag" href="/tags/infra/">Infra</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/kubernetes-in-action/">kubernetes-in-action</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/elasticsearch/">Elasticsearch</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/hands-on-reactive-programming-in-spring-5/">Hands-On Reactive Programming in Spring 5</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/spark-guide/"><div class="card-body"> <em class="small" data-ts="1666338360" data-df="ll" > Oct 21, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[스파크 완벽 가이드] 0. 스파크 시작하기</h3><div class="text-muted small"><p> 스파크 시작하기 곧 업무에서 스파크를 사용해야 해서 스파크를 재대로 공부해봐야겠다고 생각했다. 그래서 일단 local 환경에서 spark를 설치하고, 간단한 작업들을 해보려고 한다. 1. 스파크 설치 2020 m1 osx 를 기준으로 작성되었음을 알려드립니다. # java 설치 arch -arm64 brew install ope...</p></div></div></a></div><div class="card"> <a href="/posts/spark-guide-2/"><div class="card-body"> <em class="small" data-ts="1667029560" data-df="ll" > Oct 29, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[스파크 완벽 가이드] 2. 스파크 간단히 살펴보기</h3><div class="text-muted small"><p> [스파크 완벽 가이드] 2. 스파크 간단히 살펴보기 2.1 스파크의 기본 아키텍쳐 2.1.1 스파크 애플리케이션 driver 프로세스와 executor 프로세스로 구성됨. driver 프로세스는 zeppelin 같은 BI 툴이 될수도 있고, spring application같은것이 될수도 있음. 로컬 모드 위 그림과 같이 클러스터...</p></div></div></a></div><div class="card"> <a href="/posts/spark-guide-3/"><div class="card-body"> <em class="small" data-ts="1667037120" data-df="ll" > Oct 29, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[스파크 완벽 가이드] 3. 스파크 기능 둘러보기</h3><div class="text-muted small"><p> [스파크 완벽 가이드] 3. 스파크 기능 둘러보기 3.1 스파크의 기능 3.2 Dataset : 타입 안정성을 제공하는 구조적 API 자바와 스칼라의 정적 데이터 타입 코드를 지원하기 위해 고안된 구조적 API 이는 타입 안정성을 지원하고, 동적 타입 언어인 파이썬과 R에서는 사용할수 없음. case class Flight(DEST_...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/spark-guide-15/" class="btn btn-outline-primary" prompt="Older"><p>[스파크 완벽 가이드] 15. 클러스터에서 스파크 실행하기</p></a> <a href="/posts/spark-guide-17/" class="btn btn-outline-primary" prompt="Newer"><p>[스파크 완벽 가이드] 17. 스파크 배포 환경</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://sungsu9022.github.io/posts/spark-guide-16/'; this.page.identifier = '/posts/spark-guide-16/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver( function (entries) { if (entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://sungsu-parks-tech-blog.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] } ); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* Disqus hasn't been loaded */ if (typeof DISQUS === 'undefined') { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } } if (document.querySelector('.mode-toggle')) { window.addEventListener('message', reloadDisqus); } </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/spark/">Spark</a> <a class="post-tag" href="/tags/infra/">Infra</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/kubernetes-in-action/">kubernetes-in-action</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/elasticsearch/">Elasticsearch</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/effective-java/">Effective Java</a> <a class="post-tag" href="/tags/hands-on-reactive-programming-in-spring-5/">Hands-On Reactive Programming in Spring 5</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/sungsu9022dev">sungsu9022</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-145894105-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-145894105-1'); }); </script>
